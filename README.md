# Business Intelligence Challenge
You work as a Business Intelligence Analyst for a global e-commerce company that sells products across different countries and has both B2B and B2C customers. The company is experiencing rapid growth, but there are concerns about profitability in certain regions, customer retention, and pricing strategies. Your task is to analyze the company's profitability and segment the market to provide insights on where the company should focus its efforts.

---

## Dataset

### Orders Table (fields):
- OrderID (unique identifier for each order)
- OrderDate
- CustomerID
- ProductID
- QuantitySold
- UnitPrice
- Discount
- CostPerUnit (cost of the product for the company)
- TotalSales (calculated as QuantitySold * UnitPrice)
- TotalCost (calculated as QuantitySold * CostPerUnit)
- Profit (calculated as TotalSales - TotalCost)
- Country
- Region
- SalesChannel (B2B or B2C)

### Customers Table (fields):
- CustomerID
- CustomerType (B2B or B2C)
- CustomerSegment (SMB, Enterprise, Individual)
- Region
- CustomerLifetimeValue (CLV)
- LastPurchaseDate
- CustomerSince

### Product Table (fields):
- ProductID
- ProductName
- Category
- SubCategory

**Feel free to create an experimental DB according to the above schema with random data, and work on the following 3 tasks.**

---

## Task 1: SQL Query - Profitability Analysis by Customer Segment

Write an SQL query to analyze the profitability of different customer segments (B2B/B2C and SMB/Enterprise/Individual) across different regions. The goal is to determine which segments are driving profit and which are underperforming.

### Key Metrics:
- Total Profit by Region and Segment
- Average Profit per Order
- Total Sales vs Total Cost

---

## Task 2: Advanced Data Modeling - Customer Lifetime Value (CLV) and Churn Prediction

Using Power BI, build a model that includes advanced calculations for Customer Lifetime Value (CLV), segmenting customers by their purchasing behavior, and identifying potential churn risks (customers who haven't made a purchase in the last 12 months).

### Steps:
- **CLV Calculation**: Calculate the total revenue generated by a customer over time (use historical data) and determine the average CLV per customer segment.
- **Churn Prediction**: Identify customers with no purchases in the last 12 months and flag them as potential churn risks.
- **Retention Analysis**: Analyze the effectiveness of discounts and promotions on retaining high-value customers (those with the highest CLV).

### Bonus:
- Visualize customer segments based on CLV and risk of churn.
- Show trends in CLV over time and identify segments where CLV is decreasing.

---

## Task 3: Power BI Dashboard - Profitability and Customer Segmentation

Create a Power BI dashboard that provides insights into the following:

- **Regional Profitability**: Visualize profitability across different regions, including which regions have the highest and lowest profit margins.
- **Customer Segmentation**: Visualize customer segments by profitability, CLV, and risk of churn.
- **Discount Effectiveness**: Analyze the impact of discounts on profitability. Show whether discounted sales are leading to higher profits or just increasing volume at lower margins.
- **Price Sensitivity Analysis**: Identify which product categories or regions are most price-sensitive (i.e., where lower prices significantly increase sales).

### Bonus:
- Implement drill-down capabilities in the dashboard (e.g., from Region to Country to City).
- Include KPIs such as "Top 10 Most Profitable Customers" and "Top 5 Underperforming Products."

---

## Additional Challenges

- **Data Enrichment**: Use external economic data (e.g., currency exchange rates, regional inflation rates) to adjust profitability by region.
- **Forecasting**: Build a basic forecasting model in Power BI (using built-in forecasting features) to predict future sales and profitability based on historical trends.

